<div role="main">

  <p>
    <mat-toolbar>
      <span>Azure App Service Authentication</span>
    </mat-toolbar>
  </p>

  <mat-card>
    <mat-card-header>
      <mat-card-title>1 - Login</mat-card-title>
      <mat-card-subtitle>Authenticate with Azure AD to get an OAuth access token</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <p>
        <textarea readonly placeholder="The OAuth access_token will be printed here" rows="3"
          cols="50">{{ accessToken }}</textarea>
      </p>
      <button (click)="login()" mat-raised-button color="primary">Login</button>
    </mat-card-content>
  </mat-card>

  <div>
    <h3>1 - Login</h3>
    <p>Authenticate to Azure AD: </p>

  </div>

  <div>
    <h3>2 - Exchange the token</h3>
    <p>Exchange the access_token by an App Service token: </p>
    <button (click)="exchangeAccessToken()">Exchange
      Token</button>
    <p>
      <textarea readonly placeholder="The App Service .auth authorization token will be displayed here" rows="3"
        cols="50">{{ appServAuthorizationToken }}</textarea>
    </p>
  </div>

  <div>
    <h3>3 - Call the Web API running in App Service</h3>
    <button (click)="callProtectedApi()">Get Protected Data</button>
    <p>
      <textarea readonly placeholder="Protected data received from yor API" rows="3"
        cols="50">{{ protectedData }}</textarea>
    </p>
  </div>

</div>